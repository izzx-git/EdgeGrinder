Тема на форуме:
https://zx-pk.ru/threads/33491-edge-grinder-dlya-zs-gmx.html

Спасибо за помощь reddie, Evgeny Muchkin, jerri.


Для сборки запустить _All.bat
Автоматом запускается эмулятор Unreal, путь к нему должен быть прописан.

Предварительно можно в папке ConvertGFX запустить конвертацию графики ConvertEG.bat. 
Файлы палитры можно менять, тем самым меняя цвета графики.
Также для генерации выводящего спрайты кода можно запустить файл Make.bat в папке MakeGFXCode.
Для генерации кода, выводящего фон, можно запустить MakeGFXCode2.bat в папке MakeGFXCode2. 


Игра заканчивается, когда кончаются все враги (маркер число 254 в файле EG_Wave_Data_Converted.asm), а жизнь игрока не 0. 
Также можно закончить игру записав число #80  в переменную Shield.
В тексте есть указание, где включить бесконечные жизни.

Файлы:

boot.B - Стартовый файл
EG.B - Загрузчик, часть на бейсике
DISC.C - Загрузчик и генератор карты, 5 банк памяти, адрес #6200
LOADSCR.C - Картинка загрузчика,  #79 банк, адрес #c000
EDGEGRND.C- Основной код, код вывода фона, 0, 5 банк, адрес #00d0
MUSIC.C - Музыка для AY и плеер, #3e банк памяти, адрес #8000
SPRITES.C - Спрайты, 3 банк, адрес #8000
SPRITESS.C- Спрайты после попадания лазера, 1 банк, адрес #8000
CS.C- Спрайты игрока и лазера, с выводящим кодом, 7 банк, адрес #8000
CS*_*.C- Спрайты врагов с выводящим кодом, 10-15 банк, адрес #8000
BG.C - Карта и тайлы, код карты, 4 банк памяти, адрес #8000
PANELBLK.C- Код и графика титульного экрана, дополнительный код, 6 банк, адрес #8000



Подробнее:

LOADSCR.C

boot.B

MUSIC.C
Музыку можно перенести на другие адреса через ArkosTracker1 (http://www.julien-nevo.com/arkos/wp-content/uploads/ArkosTracker1_0.zip).
Исходники для Amstrad содержат нужные файлы EDGEA.SKS, WON4.SKS

SPRITES.TMP (формат от Amstrad, из этого файла генерируется код для вывода спрайтов целиком)
Спрайт занимает 126 байт, 6 байт ширина, 21 высота, занимаемое место округляется до 128
Выводится в таком порядке байт:
01 03 05 07 09 11
00 02 04 06 08 10 
13 15 17
12 14 16 18...
А последняя строчка по порядку 120 121 122 123 124 125.
Причём нули пропускаются, не выводятся. Поэтому не надо маски.

SPRITES.C (для вывода спрайтов частично у левого или правого края экрана)
Здесь формат спрайтов уже в виде
06 07 08 09 10 11
00 01 02 03 04 05
18 19 20 21 22 23
12 13 14 15 16 17
...
Последняя строчка 120 121 122 123 124 125.

SPRITESS.C

EG.B

BG.C - Карта. Тут могут быть неточности в описании.
с #db карта по 5 байт на столбик. До кода 255. Коды тайлов. Ширина столбика 16 пикселей. 
Отрисовывается справа экрана шириной по 1 пикселю и в высоту 20 знакомест. 
с адреса #1000, #1400, #1800,  #1c00 тайлы 4*4 указатели (младший байт) на расположение символов
с адреса #2000 до #3000 символы 256 штук по 8 байт, всего #1000  байт
причём левые символы с #2000, правые с #2800
Тайл шириной 16 пикселов, половинками 4 пикселя. Высота 32 байта. т.е ширина*высота 8(16)*32 байт или 16*32 пикселя
Чётные половинки сдвинуты на бит (поменяны местами левый и правый пиксель)
все тайлы карты умещаются в 64*128 пикселей или 32*128 байт =4096 байт с адреса #A000 в памяти
Расположены каждый байт через 256 байт. И в порядке 1,2,4,3,7,8,6,5 строка.

Вся карта прорисовывается до старта игры, строчками по 409 байт. С разделением на 8 страниц.
Страница 0
0-39 строка, 0-408 столбец
Страница 1
40-79 строка, 0-408 столбец
Страница 2
80-119 строка, 0-408 столбец
Страница 3
120-159 строка, 0-408 столбец, сдвиг на пиксель
Страница 4
0-39 строка, 0-408 столбец, сдвиг на пиксель 
Страница 5
40-79 строка, 0-408 столбец, сдвиг на пиксель
Страница 6
80-119 строка, 0-408 столбец, сдвиг на пиксель
Страница 7
120-159 строка, 0-408 столбец, сдвиг на пиксель

Страница 8
0-39 строка, 409-817 столбец
...

EDGEGRND.C

CS.C

PANELBLK.C

DISC.C



